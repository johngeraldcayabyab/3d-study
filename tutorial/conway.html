<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Conway</title>
</head>
<body>
<script type="module">

    async function init() {
        // Your WebGPU code will begin here!

        if (!navigator.gpu) {
            throw new Error('WebGPU not supported in this browser');
        }

        const adapter = await navigator.gpu.requestAdapter();
        if (!adapter) {
            throw new Error('No appropriate GPU adapter found');
        }

        const device = await adapter.requestDevice();

        const canvas = createCanvas();
        const context = canvas.getContext('webgpu');
        const canvasFormat = navigator.gpu.getPreferredCanvasFormat();
        context.configure({
            device: device,
            format: canvasFormat,
        });

        const encoder = device.createCommandEncoder();

        const pass = encoder.beginRenderPass({
            colorAttachments: [{
                view: context.getCurrentTexture().createView(),
                loadOp: 'clear',
                storeOp: 'store',
                clearValue: {r: 0, g: 0, b: 0.4, a: 1}
            }]
        });

        pass.end();

        const commandBuffer = encoder.finish();

        device.queue.submit([commandBuffer]);
    }


    function createCanvas() {
        const canvas = document.createElement("canvas");
        canvas.width = 512;
        canvas.height = 512;
        document.body.appendChild(canvas);
        return canvas;
    }

    init();
</script>
</body>
</html>
